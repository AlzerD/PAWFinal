<div class= "span20 center-table">

  <% if (params[:block].to_i == 0) %> 
    <h1>Administer matches</h1>
  <% else %>
    <h1>Block <%= @matches[0].block %></h1>
  <% end %>  

  <table class="table table-bordered table-condensed table-striped" >
    <thead>
      <tr>
        <th style = 'display: none'></th>       
        <th class="col-sn-1">ID</th>
        <th class="col-sn-1">Block</th>
        <th class="col-sn-1">Round</th>
        <th class="span2">Date</th>
        <th class="col-sn-1">Day</th>
        <th class="col-sn-1">Time</th>
        <th class="col-sn-1">Venue</th>
        <th class="col-sn-1">Team1</th>
        <th class="col-sn-1">Team2</th>
        <% if (params[:block].to_i == 0) %> 
          <th class="col-sn-1">Result</th>
          <th class="col-sn-1">Result String</th>
          <th class="col-sn-1">Played</th>
        <% else %>      
          <th class="col-sn-1">User Pick</th>
        <% end %>
        <th style = 'display: none'></th> 
      </tr>
    </thead>

    <tbody>
      <%= form_tag create_match_pick_path, :method => :post do %>
        <% @matches.each do |match| %>
          <tr>
            <td style = 'display: none'></td>
            <td><%= match.id %></td>
            <td><%= match.block %></td>
            <td><%= match.round %></td>
            <td><%= match.date %></td>
            <td><%= match.day %></td>
            <td><%= match.time %></td>
            <td><%= match.venue %></td>
            <td><%= match.team1 %></td>
            <td><%= match.team2 %></td>

            <% if (params[:block].to_i == 0) %> 
            <td><%= match.result %></td>
            <td><%= match.resultString %></td>
            <td><%= match.played %></td>
            <td><%= link_to 'Update', edit_match_path(match) %></td>
            <% else %>
            <td><%= select_tag "user_picks[]", options_for_select([["Draw", "0"], [match.team1, "1"], [match.team2, "2"]]), disabled: false, 'data-id' => match.id, :class => 'match_option' %></td>            
            <td style = 'display:none'><%= check_box_tag "match_ids[]", match.id, false, :class => 'matchid', checked: true %></td>
            
            <% end %>       
          </tr>
        <% end %>
    </tbody>      
  </table>   
        <% if ((params[:block].to_i != 0)&&(current_user.curr_block==params[:block].to_i - 1)) %> 
          <%= button_tag :class => "btn-large btn-primary" do %> Submit Picks <% end %> 
        <% else %> 
          <p>You must complete your block picks in order. Please submit Block <%= (current_user.curr_block)+1 %> picks first<p>
        <% end %>
  
      <% end %>
</div>

<script type="text/javascript">
$('.matchid').on('click', function () {
    var dataid = $(this).val();
    if (this.checked) {
        $('select[data-id="'+ dataid +'"]').prop('disabled', false);
    } else {
        $('select[data-id="'+ dataid +'"]').prop('disabled', true);
    }
}); 
</script>





